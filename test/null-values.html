<html>

<head>

<title>Null Values</title>

<script src="../src/chartlets.js"></script>

<!-- Documentation Style -->
<style>
.chartlet{border:1px solid #ddd;margin:2px}body{font-family:Helvetica,Arial;background-color:#fff;padding:20px 50px}header{margin-bottom:50px}footer{font-size:.8em;color:#999}h1,h2,h3{font-family:Helvetica,Arial;font-weight:400;color:#222;margin:0;padding:0}h1{font-size:3.75em}h2{font-size:1.7em}h3{font-size:1.5em;margin-bottom:.25em;color:hsl(336,76%,50%)}p{font-family:Helvetica,Arial}a,a:visited{color:hsl(225,65%,50%)}a:hover{color:hsl(336,76%,50%)}small{font-size:.75em;color:#999}section{margin-bottom:50px}#download{text-align:right;font-size:1.35em;font-weight:700;color:#222}table.examples tr td{padding:0 10px 15px 0}td,th{text-align:left;vertical-align:top}.highlight{background-color:#ffc;border:1px solid #fc3;padding:1px 2px;border-radius:4px}.swatch,.tx{display:inline-block}.swatch p{margin:4px 0;color:#999;font-size:.9em}.tx{margin:10px 10px 10px 0}.tx canvas{display:block;margin-bottom:6px}code,pre{font-family:Monaco,Courier,monospace;font-size:.8em}li strong{color:hsl(336,76%,50%)}@media only screen and (max-width: 480px){body{padding:8px}h1{font-size:3em}code,pre{white-space:pre-wrap;word-break:break-all}td,th{padding:2px}}
</style>

<style>
canvas {
  border: 1px solid #ddd;
}

table tr td span:first-child{color:red;}
table tr td span:nth-child(2){color:green;}
table tr td span:nth-child(3){color:blue;}
table tr td span:nth-child(4){color:orange;}
table tr td span:nth-child(5){color:teal;}
table tr td span:nth-child(6){color:brown;}
</style>

</head>

<body>
  <h2>Advanced Usage: 6 - Null/NaN Values</h2><br>
  
  <h3>6.1 Bar Charts and Zero Values</h3>

  <section id="options">
    <p>
      For <code>bar</code> chart, by default zero values will not be plotted and will leave an empty space both in stacked and non-stacked bar charts. But if it is required to have zero values leave a hint, an option <code>mapZeroValueTo</code> can be configured inside <span class="highlight">data-opts</span> to map zero values to a non-zero decimal value. See the below demonstrations:
    </p>
  </section>

  <div class="documentation">
  </div>

  <table cellspacing="50">
    <tr><td colspan="3"><hr></td></tr>

    <!-- Test Case -->
    <tr><td></td><td colspan="2" style="text-align:center;">6.1.1 Bar Chart with Zero Values in Set</td></tr>
    <tr>
      <td colspan="2">
        <canvas  class="chartlet" 
          data-type="bar"
          data-colors="red green blue orange teal brown" 
          data-sets="[0 30 12 43 0 33]"
          width="200" height="150">
        </canvas>
      </td>
      <td>
        <code>
          <canvas  class="chartlet" 
          data-type="bar"
          data-colors="red green blue orange teal brown" 
          data-sets="[0 30 12 43 0 33]"
          width="200" height="150">
        </canvas>
      </td>
    </tr>
    <tr><td colspan="3"><hr></td></tr>

    <!-- Test Case -->
    <tr><td></td><td colspan="2" style="text-align:center;">6.1.2 Bar Chart with <b>Mapped</b> Zero Values in Set</td></tr>
    <tr>
      <td colspan="2">
        <canvas  class="chartlet" 
          data-type="bar"
          data-colors="red green blue orange teal brown" 
          data-sets="[0 30 12 43 0 33]"
          width="200" height="150"
          data-opts="mapZeroValueTo:2">
        </canvas>
      </td>
      <td>
        <code>
          <canvas  class="chartlet" 
          data-type="bar"
          data-colors="red green blue orange teal brown" 
          data-sets="[0 30 12 43 0 33]"
          width="200" height="150"
          data-opts="mapZeroValueTo:2">
        </canvas>
      </td>
    </tr>
    <tr><td colspan="3"><hr></td></tr>

    <!-- Test Case -->
    <tr><td></td><td colspan="2" style="text-align:center;">6.1.3 Stacked Bar Chart with Zero Values in Sets</td></tr>
    <tr>
      <td colspan="2">
        <canvas  class="chartlet" 
          data-type="bar"
          data-colors="red green blue orange teal brown" 
          data-sets="[0 30 12 15 0 -13] [0 0 12 10 10 0] [0 0 12 -5 10 13]"
          width="200" height="150"
          data-opts="axis:0 transform:stack">
        </canvas>
      </td>
      <td>
        <code>
          <canvas  class="chartlet" 
          data-type="bar"
          data-colors="red green blue orange teal brown" 
          data-sets="[0 30 12 43 0 -13] [0 0 12 43 10 0] [0 0 12 43 10 13]"
          width="200" height="150"
          data-opts="axis:0 transform:stack">
        </canvas>
      </td>
    </tr>
    <tr><td colspan="3"><hr></td></tr>

    <!-- Test Case -->
    <tr><td></td><td colspan="2" style="text-align:center;">6.1.4 Stacked Bar Chart with <b>Mapped</b> Zero Values in Sets</td></tr>
    <tr>
      <td colspan="2">
        <canvas  class="chartlet" 
          data-type="bar"
          data-colors="red green blue orange teal brown" 
          data-sets="[0 30 12 15 0 -13] [0 0 12 10 10 0] [0 0 12 -5 10 13]"
          width="200" height="150"
          data-opts="axis:0 transform:stack mapZeroValueTo:5">
        </canvas>
      </td>
      <td>
        <code>
          <canvas  class="chartlet" 
          data-type="bar"
          data-colors="red green blue orange teal brown" 
          data-sets="[0 30 12 15 0 -13] [0 0 12 10 10 0] [0 0 12 -5 10 13]"
          width="200" height="150"
          data-opts="axis:0 transform:stack mapZeroValueTo:5">
        </canvas>
      </td>
    </tr>
    <tr><td colspan="3"><hr></td></tr>
  </table>
  

  <h3>6.2 Line Charts and Zero Values</h3>

  <section id="options">
    <p>
      For <code>line</code> charts, by default markers on zero values will tend to touch the zero axis. The behavior can be overridden by providing a mapper function. Zeros values in <code>line</code> charts cannot be plotted as empty spaces because a Line series is supposed to be a connected series thus zero values should be normalised to valid decimal values. The normalisation can be calculated based on values occurring before or after the zero value or by some algorithm applied on zero value's set or all sets. To allow this a mapper function can be provided by <code>zeroValueMapperFn</code> inside <span class="highlight">data-opts</span>. The value of <code>zeroValueMapperFn</code> must be the name of a function present in global (window) scope. For each zero value this function will be called with the following parameters injected in order:
      <ul>
        <li><strong>previousValue</strong> Value occurring before the zero value or <code>undefined</code> if start of set.</li>
        <li><strong>nextValue</strong> Value occurring next the zero value or <code>undefined</code> if end of set.</li>
        <li><strong>index</strong> The index of the zero value in current set.</li>
        <li><strong>set</strong> Current set (Array).</li>
        <li><strong>sets</strong> All sets (Array of Arrays).</li>
      </ul>
      See the below demonstrations:
    </p>
  </section>

  <table cellspacing="50">
  <tr><td colspan="3"><hr></td></tr>

    <!-- Test Case -->
    <tr><td></td><td colspan="2" style="text-align:center;">6.2.1 Line Chart with Zero Values in Sets</td></tr>
    <tr>
      <td colspan="2">
        <canvas id="test_1b" 
          class="chartlet" 
          data-type="line" 
          data-sets="[1 2 0 3 5 6 7 8 0 10] [10 0 8 7 6 0 4 3 6 1] [20 8 6 0 6 6 5 4 0 2]" 
          data-colors="#f00 #0f0 #00f" 
          width="200" 
          height="150" 
          data-opts="cap:circle shape:smooth">
        </canvas>
      </td>
      <td>
        <code>
          <canvas id="test_1b" 
          class="chartlet" 
          data-type="line" 
          data-sets="[1 2 0 3 5 6 7 8 0 10] [10 0 8 7 6 0 4 3 6 1] [20 8 6 0 6 6 5 4 0 2]" 
          data-colors="#f00 #0f0 #00f" 
          width="200" 
          height="150" 
          data-opts="cap:circle shape:smooth">
        </canvas>
      </td>
    </tr>
    <tr><td colspan="3"><hr></td></tr>
    
    <!-- Test Case -->
    <tr><td></td><td colspan="2" style="text-align:center;">6.2.2 Line Chart with Disconnected Zero Values</td></tr>
    <tr>
      <td colspan="2">
        <canvas id="test_1b" 
          class="chartlet" 
          data-type="line" 
          data-sets="[1 2 0 3 5 6 7 8 0 10] [10 0 8 7 6 0 4 3 6 1] [20 8 6 0 6 6 5 4 0 2] [0 2 4 6 8 0 6 4 2 0]" 
          data-colors="#f00 #0f0 #00f #333"
          width="200" 
          height="150" 
          data-opts="shape:smooth disconnectOn:0">
        </canvas>
      </td>
      <td>
        <code>
          <canvas id="test_1b" 
          class="chartlet" 
          data-type="line" 
          data-sets="[1 2 0 3 5 6 7 8 0 10] [10 0 8 7 6 0 4 3 6 1] [20 8 6 0 6 6 5 4 0 2]" 
          data-colors="#f00 #0f0 #00f" 
          width="200" 
          height="150" 
          data-opts="shape:smooth disconnectOn:0">
        </canvas>
      </td>
    </tr>
    <tr><td colspan="3"><hr></td></tr>

    <!-- Test Case -->
    <tr><td></td><td colspan="2" style="text-align:center;">6.2.3 Stacked Line Chart with <b>Mapped</b> Zero Values in Sets</td></tr>
    <tr>
      <td colspan="2">
        <canvas id="test_1b" 
          class="chartlet" 
          data-type="line" 
          data-sets="[1 2 0 3 5 6 7 8 0 10] [10 0 8 7 6 0 4 3 6 1] [20 8 6 0 6 6 5 4 0 2]" 
          data-colors="#f00 #0f0 #00f" 
          width="200" 
          height="150" 
          data-opts="cap:circle shape:smooth zeroValueMapperFn:averageZeroValue">
        </canvas>
        <br><br>
        <script type="text/javascript">
          function averageZeroValue(previousValue, nextValue, index, currentSet, sets) {
            return (previousValue || 0) + (nextValue || 0) / 2;
          }
        </script>
      </td>
      <td>
        <code>
          <canvas id="test_1b" 
          class="chartlet" 
          data-type="line" 
          data-sets="[1 2 0 3 5 6 7 8 0 10] [10 0 8 7 6 0 4 3 6 1] [20 8 6 0 6 6 5 4 0 2]" 
          data-colors="#f00 #0f0 #00f" 
          width="200" 
          height="150" 
          data-opts="cap:circle shape:smooth zeroValueMapperFn:averageZeroValue">
        </canvas>
        </code>
        <br><br>
        <code>
          <script type="text/javascript">
            function averageZeroValue(previousValue, nextValue, index, currentSet, sets) {
              return (previousValue || 0) + (nextValue || 0) / 2;
            }
          </script>
        </code>
      </td>
    </tr>
    <tr><td colspan="3"><hr></td></tr>

    <!-- Test Case -->
    <tr><td></td><td colspan="2" style="text-align:center;">6.2.4 Stacked Line Chart with Zero Values in Sets</td></tr>
    <tr>
      <td colspan="2">
        <canvas id="test_1b" 
          class="chartlet" 
          data-type="line" 
          data-sets="[1 2 0 3 5 6 7 8 0 10] [10 0 8 7 6 0 4 3 6 1] [20 8 6 0 6 6 5 4 0 2]" 
          data-colors="#f00 #0f0 #00f" 
          width="200" 
          height="150" 
          data-opts="cap:circle shape:smooth  transform:stack">
        </canvas>
      </td>
      <td>
        <code>
          <canvas id="test_1b" 
          class="chartlet" 
          data-type="line" 
          data-sets="[1 2 0 3 5 6 7 8 0 10] [10 0 8 7 6 0 4 3 6 1] [20 8 6 0 6 6 5 4 0 2]" 
          data-colors="#f00 #0f0 #00f" 
          width="200" 
          height="150" 
          data-opts="cap:circle shape:smooth  transform:stack">
        </canvas>
      </td>
    </tr>
    <tr><td colspan="3"><hr></td></tr>

    <!-- Test Case -->
    <tr><td></td><td colspan="2" style="text-align:center;">6.2.5 Stacked Line Chart with Disconnected Zero Values</td></tr>
    <tr>
      <td colspan="2">
        <canvas id="test_1b" 
          class="chartlet" 
          data-type="line" 
          data-sets="[1 2 0 3 5 6 7 8 0 10] [10 0 8 7 6 0 4 3 6 1] [20 8 6 0 6 6 5 4 0 2]" 
          data-colors="#f00 #0f0 #00f" 
          width="200" 
          height="150" 
          data-opts="cap:circle shape:smooth  transform:stack disconnectOn:0">
        </canvas>
      </td>
      <td>
        <code>
          <canvas id="test_1b" 
          class="chartlet" 
          data-type="line" 
          data-sets="[1 2 0 3 5 6 7 8 0 10] [10 0 8 7 6 0 4 3 6 1] [20 8 6 0 6 6 5 4 0 2]" 
          data-colors="#f00 #0f0 #00f" 
          width="200" 
          height="150" 
          data-opts="cap:circle shape:smooth  transform:stack disconnectOn:0">
        </canvas>
      </td>
    </tr>
    <tr><td colspan="3"><hr></td></tr>

    <!-- Test Case -->
    <tr><td></td><td colspan="2" style="text-align:center;">6.2.6 Stacked Line Chart with <b>Mapped</b> Zero Values in Sets</td></tr>
    <tr>
      <td colspan="2">
        <canvas id="test_1b" 
          class="chartlet" 
          data-type="line" 
          data-sets="[1 2 0 3 5 6 7 8 0 10] [10 0 8 7 6 0 4 3 6 1] [20 8 6 0 6 6 5 4 0 2]" 
          data-colors="#f00 #0f0 #00f" 
          width="200" 
          height="150" 
          data-opts="cap:circle shape:smooth transform:stack zeroValueMapperFn:averageZeroValueLine">
        </canvas>
        <br><br>
        <script type="text/javascript">
          function averageZeroValueLine(previousValue, nextValue, index, currentSet, sets) {
            return (previousValue || 0) + (nextValue || 0) / 2;
          }
        </script>
      </td>
      <td>
        <code>
          <canvas id="test_1b" 
            class="chartlet" 
            data-type="line" 
            data-sets="[1 2 0 3 5 6 7 8 0 10] [10 0 8 7 6 0 4 3 6 1] [20 8 6 0 6 6 5 4 0 2]" 
            data-colors="#f00 #0f0 #00f" 
            width="200" 
            height="150" 
            data-opts="cap:circle shape:smooth transform:stack zeroValueMapperFn:averageZeroValueLine">
          </canvas>
        </code>
        <br><br>
        <code>
          <script type="text/javascript">
            function averageZeroValueLine(previousValue, nextValue, index, currentSet, sets) {
              return (previousValue || 0) + (nextValue || 0) / 2;
            }
          </script>
        </code>
      </td>
    </tr>
    <tr><td colspan="3"><hr></td></tr>

  </table>

  <!-- JavaScript Tweek for displaying HTML code -->
  <script type="text/javascript">
    String.prototype.escapeHTML = function () {                                        
      return(                                                                 
        this.replace(/>/g,'&gt;').
             replace(/</g,'&lt;').
             replace(/"/g,'&quot;')
      );
    };

    var codeElementsIndex, codeElements = document.getElementsByTagName('code');
    for(codeElementsIndex=0; codeElementsIndex < codeElements.length; codeElementsIndex++) {
      var codeElement = codeElements[codeElementsIndex];
      if('undefined' != typeof codeElement.innerHTML)
        codeElement.innerHTML = codeElement.innerHTML.escapeHTML();
    }

    Chartlets.render();
  </script>
</body>
